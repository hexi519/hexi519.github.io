---
top: false
cover: false
mathjax: true
title: smore
date: 2020-11-23 10:10:21
categories: ExtensiveReading
description: cornell,CMU,facebook@NSDI‘18
tags: - Network
    - Routing
---



# hesy summary

集中式

* 解决了路由方案扩展性的问题？



容量异质性(capacity heterogeneity)，这个的意思就是不同WAN中流量的cdf分布不一致（如论文图2）



# abstract

​	预期网络将在广泛的运行条件下提供可靠的性能，但是**现有的流量工程（TE）解决方案针对性能或鲁棒性进行了优化，但不能同时针对两者进行优化**。 影响TE系统质量的关键因素是用于承载流量的路径集。 一些系统依赖于最短路径，这会导致具有瓶颈链路的拓扑过度拥塞，而另一些系统则使用使拥塞最小化的路径，这些路径既脆弱又容易出现故障。 本文介绍了一种系统，该系统使用通过Räcke的无察觉路由算法计算出的一组路径，以及一个**集中控制器**来动态调整发送速率。 尽管先前已经单独研究了遗忘路由和集中式TE，但是它们的组合是新颖而强大的。 我们构建了一个软件框架来对TE解决方案进行建模，并在大量拓扑和场景中进行了广泛的实验，包括大型内容提供商和ISP的生产骨干。 我们的结果表明，半遗忘的路由提供了近乎最佳的性能，并且比最新系统更健壮。



#  1 Introduction

> 即使出现意料之外的流量变化和彻底的故障，网络也有望提供良好的性能。 但是，**<u>尽管有大量文献介绍了如何最佳地通过网络路由流量，同时针对诸如最小化拥塞等目标进行优化[3，9，13，14，15，22，24，26，47]，当前的流量工程 当操作条件与预期不符时，（TE）解决方案的性能可能会很差[32，42]。</u>** 
>
> 性能和可靠性之间的紧张关系不仅是假设的问题。 诸如Google [18,24]和Microsoft [22,32]之类的领先技术公司已确定将这些属性视为其专用网络的关键问题。 例如，Google B4系统的主要目标是将链接利用率提高到100％，但这意味着发生故障时“不可避免”地丢包[24]。 同时，谷歌对可用性的另一项研究确定了“每月不超过几分钟的停机时间”为目标，**<u>停机时间被定义为丢包率超过0.1％-2％[18]</u>**。 
>
> 退一步，可以看到在任何TE系统的设计中都有两个基本选择：（i）哪些转发路径用于将流量从源传送到目的地，以及（ii）哪个发送速率用于平衡传入的流量 流量在这些路径之间流动。**<u>【走哪里，发多少】</u>** 可以从这些选择的角度看待任何TE解决方案，但也有一些实际考虑因素限制了可部署系统的种类。 例如，设置和拆除端到端转发路径是一个相对较慢的操作，尤其是在广域网中，这对网络通过修改集合对动态变化的反应速度有一个基本的下限。 转发路径[25]。 另一方面，修改现有的一组转发路径的发送速率是一种相对便宜的操作，几乎可以在现代交换机上即时实现[32]。 另一个重要的考虑因素是实现TE解决方案所需的转发表的大小，因为每个交换机上可以安装多少个路径是有限制的[7、22、42]。 
>
> 这些考虑表明，获得可靠性能的关键因素是选择一小组不同的转发路径，这些路径能够在各种故障情况下满足各种需求。 不幸的是，现有的TE解决方案无法应对这一挑战。 例如，在最简单的设置中使用k最短路径效果很好，但导致带有shortcut links的拓扑过度拥塞，这成为了瓶颈。 **<u>在节点对之间使用k个edge-disjoint的路径并不会带来更好的效果，因为不同节点对之间的路径仍在争夺瓶颈链路上的带宽[24,32]。</u>** 
>
> 使用contraint solver来计算针对给定方案和目标进行了优化的转发路径，可以有效地避免瓶颈，但它也可以“过度适应”特定方案，从而产生易碎且容易出错的解决方案。 另外，很难对求解器使用的路径数量施加预算，并且用于修剪路径集的常见启发式方法会降低性能[42]。 



**Approach**

> 我们介绍Smore，这是一种基于两种关键成分的新型TE系统。 
>
> * 首先，它使用通过oblivious routing^1^ [38,39]计算的一组转发路径，而不是像当前方法[22、24、32]那样使用最短，边不相交或最优的路径。 
>
>   通过遗忘路由计算出的路径具有三个重要特性：它们的伸缩性很低，种类繁多并且自然地平衡了负载。 
>
> * 其次，它动态地调整这些路径上的发送速率[9,22,26,28,47]，以适应当前需求并对故障做出反应。 
>
> * 虽然中已经探讨过这些想法**<u>in isolation</u>** previously[3、7、20]，但它们的组合却出奇地强大，并且使Smore可以实现接近最佳的性能。
>
> * 我们的工作是对这种联合方法（称为semi-oblivious路由）的首次实际实施和全面评估。 Through extensive experiments with data from the **<u>production networks of a large content provider (anonymized as BigNet) and a major ISP,</u>** as well as large-scale simulations, 我们证明Smore实现了接近最佳的性能，与最先进的解决方案[22，24]相比，**<u>并且比文献中预测的最坏情况更好</u>**。  **<u>Smore还达到了一定程度的鲁棒性，在明确设计为容错的解决方案上有所提高[32，42]。</u>**



**Contribution**

   1.我们确定了**<u>TE系统的通用模型</u>**==这种什么东西...每篇文章都有==，并针对广域TE（§2）提供了各种方法。
   2.我们介绍Smore的设计并讨论影响性能和鲁棒性（§3）的关键属性。
   3.我们演示了Smore在生产网络上的可部署性，并开发了用于建模和评估TE系统的框架（第4节）。
   4.我们进行了广泛的评估，将Smore与其他系统在各种情况下进行了比较（第5至6节）。



#  2 System Model and Related Work
<img src="https://gitee.com/HesyH/Image-Hosting/raw/master/image4typora/202011/23/115740-673919.png" alt="image-20201123115739164" style="zoom:67%;" />

> 本节建立了一个通用模型，该模型捕获了TE系统的基本行为并简要调查了该地区的相关工作。 抽象地，TE系统可以通过两个基本选择来表征：使用哪个转发路径来承载流量，以及如何在这些路径上分配流量。 这在图1所示的模型的两个阶段中得以捕获：（i）路径选择和（ii）速率自适应。 

​	第一阶段将网络拓扑映射到连接每对节点的一组转发路径。 通常，该阶段仅很少执行（例如，当拓扑更改时），**<u>因为更新端到端转发路径是一个相对较慢的操作</u>**。 实际上，由于更新多个地理分布设备上的TCAM所需的时间，在广域网中更新端到端路径可能要花几分钟的时间。 

​	在第二阶段，系统获取有关当前需求和故障的信息，并生成一组加权路径，这些路径描述了应如何将传入流映射到这些路径上。 **<u>由于更新路径权重是一个相对较快的操作</u>**，因此该阶段可以随着条件的变化而连续执行。 例如，当需求变化时，系统可能会更新权重以重新平衡负载，或者在链路断开时将某些路径的权重设置为零。 本文研究的主要挑战是如何设计一个TE系统，该系统在第一阶段选择一小组路径，从而能够灵活地处理第二阶段的许多不同情况。



## 2.1 Path Properties

​	本文的中心论点是，路径选择对TE系统的性能和鲁棒性有很大影响。 即使对于包含动态速率自适应阶段以针对特定性能目标进行优化的系统，所选路径集也至关重要，**<u>因为它定义了优化的状态空间</u>**。 **<u>理想的路径属性包括：</u>**

​	A.==低延展性（low stretch）==以最小化等待时间； ==这是啥==

​	B.高多样性以确保鲁棒性； ==不是说了一旦确定一组就很难换么....还是说选择的时候就要想好...==

​	C.良好的负载平衡以实现性能。	

​	不幸的是，如表1所示，当前的TE系统无法保证这些特性中的至少一个。

> **<u>例如，由于两个基本原因，基于k最短路径（KSP）的方法无法在许多拓扑中提供良好的负载平衡特性。</u>** <u>首先，KSP无法识别容量。</u> 请注意，广域拓扑会随着时间的发展而发展以满足不断增长的需求[18]，从而导致异构链路容量，如图2所示。由于KSP不考虑容量，因此它经常过度利用位于许多最短链路上的低容量链路。 使用容量的倒数作为链路权重是解决此问题的常用技术，但是由于容量异质性(capacity heterogeneity)，可能导致延迟增加。 
>
> <u>其次，由于KSP独立计算每对节点之间的路径</u>，因此它不会考虑任何给定的链路是否已被其他节点对大量使用。 因此，缺乏这种全局优化路径选择的概念，即使转向使用看似更多样化的边不相交的k最短路径，所有节点对的路径并集仍可能会过度利用瓶颈链路。
>
> ==我觉得独立决策的情况下，很难避免路由震荡的情况啊...也许ECMP就是考虑到这个才使用平均分的方式，which是最好的负载方法？或许可以拿概率来算一算...比如说互联网中出现90%的容量的概率是...,我们以xx%的概率xxx==
>
> ==别人都是如何防止路由震荡的？？还是说没有考虑这个问题？主要还是得看传统的算法？==

​	<u>通常，要实现低伸缩性和良好的负载平衡特性，路径选择算法必须具有容量意识并进行全局优化。</u> 为了进行说明，请考虑图3中的拓扑，其中单位流以f1，f2和f3的顺序到达。 

> 在图3a中，如在KSP中一样，我们使用最短路径进行路由，因此链路（G，E）变得拥塞。 在图3b中，我们像CSPF一样，按到达顺序为每个流贪婪地分配了具有足够容量的最短路径，这会导致局部最优但全局次优的路径集，因为某些路径具有较高的延迟。 最后，在图3c中，我们描述了全局最优路径集。 面临的挑战是要计算出一组与这些最佳路径的性能非常接近的路径，同时在实践中仍然可行。==这个最佳性能是怎么算出来的呢？LP?==



## 2.2 Related work

​	**<u>教科书中有关TE的方法将我们模型中的两个阶段合并在一起，并作为一个组合优化问题进行构架</u>**：给定网络拥塞且节点之间的流量需求一系列，找到对路径进行流量分配以针对某些标准进行优化， 例如最小化<u>最大链接利用率（MLU）</u>。 在文献中，这被称为<u>多商品流（multi commodity flow, MCF）</u>问题，并且已经被广泛研究。 如果流被限制为在节点对之间使用单个路径，则问题是**NP完全**的。 但是，如果允许分数流（fractional flows），则可以使用线性规划（LP）在强多项式时间（**<u>strongly polynomial time</u>**）内找到最优解[44]。

​	在实践中已广泛使用的**<u>另一种方法是调整OSPF和ECMP等分布式路由协议中的链路权重</u>**，因此它们计算出一组良好的转发路径[14、15]，并且不执行任何速率适配 。 **这种方法易于利用，因为它利用了广泛使用的常规协议的功能，但是为ECMP优化链路权重是NP难题。**==优化ECMP的链路权重是什么...== 而且，当发生故障时或在重新收敛之后，链路权重被修改以反映新的需求时，它的性能通常很差。  **<u>COYOTE [8]</u>**的目的是通过伪造的协议消息仔细地操纵每个交换机的视图，从而提高这种分布式方法的性能。

​	**<u>几个最近的集中式TE系统明确地分离了路径选择和速率适配的各个阶段</u>**。  SWAN [22]使用LP公式在k最短路径的子集中分配流量，该公式为配置更新保留了少量的“临时容量”。  Suchara等人提出的系统。  [42]（以下称为“ R-MCF”）执行了鲁棒的优化，将故障合并到LP公式中以离线计算各种路径。 然后，它使用简单的本地方案动态调整每个源的发送速率。  Chang等人的最新工作。  [6]还使用鲁棒性优化来验证设计，该设计提供的性能和鲁棒性保证优于最坏情况的范围。  FFC [32]推荐（p，q）链路-交换机分离路径，并根据LP分配流量，以确保对多达k个任意故障的适应性。  B4 [24]根据需求贪婪地选择路径。 它使用BwE [28]和启发式优化将流划分为路径，从而在确保公平性的同时提高利用率。 

​	另一项工作是探索oblivious approaches的空间，这些方法可以在存在任意需求的情况下提供有力的保证[2,3,7]。 有效负载平衡（VLB）通过随机选择的中间节点路由流量。  VLB最初是作为在并行计算机中平衡负载的一种方法而提出的[45]，最近已在包括WAN [48]在内的许多其他设置中应用了VLB。 但是，使用中间节点会增加路径长度，这可能会大大增加延迟（例如，考虑将流量从纽约经由巴黎路由到西雅图）。 

​	Oblivious routing概括了VLB，它计算了low-stretch==？？==路径上的概率分布，并根据该分布转发流量，而不管部署时发生什么需求，换句话说，it is oblivous routing。 值得注意的是，存在一些遗忘的路由方案，其拥塞率is never worse than O(logn) fatcor of optimal==??==。  Räcke[38]在突破性论文中提出了一种这样的方案，该方案构造了一组树状结构的叠加层，然后使用这些叠加层来构建随机转发路径。 尽管对于最坏情况的保证，oblivious路由的O（logn）拥塞率异常高，但仍然需要大量的超额配置容量（overprovisionaling capacities by a significant amount）。  Applegate和Cohen [3]开发了一种最佳遗忘路由的LP公式。 他们表明，与Räcke的结果建议的O（logn）过度配置相反，在大多数情况下，**<u>将每个边缘的容量过度配置2倍或更小就足够了</u>**。 尽管比最坏情况下的性能要好，但它与最新技术仍然没有竞争力。 这导致我们探索通过动态速率自适应来增加用于路径选择的遗忘路由，以实现更好的性能。



#  3 Smore Design

​	我们针对Smore的设计遵循上一节介绍的两阶段系统模型：我们使用oblivous routing（§3.1）选择转发路径，并使用约束优化器（§3.2）连续调整这些模型的发送速率 路径。 这种方法可确保Smore中使用的路径通过构造具有第2节中讨论的属性，即它们是低伸缩，多样化且负载均衡的。

> ​	在实际存在资源约束的情况下，基于预期需求执行鲁棒的多目标优化来计算路径是具有挑战性的[6，32]。 此外，如果实际情况与预测的情况有所不同（例如，由于故障而导致的情况），或者在ISP（客户可能以难以预期的方式行事的ISP）中，性能通常会受到影响[3]。 相反，**<u>由于遗忘路由中的路径是在不了解需求的情况下进行计算的，因此它们避免了对任何特定情况的过度拟合</u>**，从而使系统自然变得健壮。 <u>最后，Smore预先配备了一种简单的机制，用于对使用的路径总数施加预算</u>，这使它在存在资源限制的情况下可以优雅地降级，这与许多其他方法不同。



##  3.1 Path selection

> 前面的符号介绍就先不说了

与其他著名的路径选择算法（例如ECMP，KSP，不相交的k最短路径（EDKSP），VLB和MCF使用代表性的WAN拓扑）相比，我们将说明Smore选择的路径集如何具有所需的属性。  （Hibernia大西洋）.2图4显示了各种算法为所有节点对选择的路径，并使用颜色编码指示负载（即，使用每个链接的路径权重之和）。 插图显示了每种算法为不同节点对选择的路径的延迟。 一种。



### Ａ. Smore's path have low stretch

拉克（Räcke）构建RRT的核心要点是从无遗漏的路由减少到计算低拉伸路由树的问题，定义如下。 输入是一个无方向图G，其边缘分配有正长度ℓ（e）和权重w（e）。 路径P的长度ℓ（P）定义为其edge长度的总和，路由树T的平均长度定义为加权总和的比率

![image-20201124160256402](https://gitee.com/HesyH/Image-Hosting/raw/master/image4typora/202011/24/160301-428411.png)

将路径P的长度ℓ（P）定义为其边缘长度的总和，并将路由树T的平均长度定义为加权总和的比率，其中两个总和都位于G的所有边缘上 问题是选择T以便使该数量最小化，这可以解释为（加权的）平均数量，当我们使用T确定的路径将其连接到端点e时，我们将其增加边缘e的长度。 



在低伸展路由树问题上，由于Fakcharoenphol，Rao和Talwar（FRT）[10]，存在一种平均伸展O（logn）的解决方案和一种随机算法，可以有效地找到这种树。 该算法通过计算G中所有对的最短路径来定义度量空间，然后将该度量空间分层分解为直径逐渐减小的簇，每个簇都有一个称为簇中心的独特顶点。 路由树的拓扑定义为该层次结构分解的哈斯图（hass diagram），该层次通过包含进行排序，并且与其边缘关联的路径是相应群集中心之间的最短路径。 因此，要从源u路由到目的地v，需要通过遍历整个层次结构来构造从u构成的路径，采用最短路径到达越来越大的群集的中心，直到到达包含u和u的群集的中心。  v; 我们将此中心称为最不常见的祖先（LCAu，v）； 然后一个相反的过程将路由从该群集中心路由到v。如果u和v都属于群集C，则这样构造的路径的长度将受到C直径的常数倍的限制。这解释了为什么路径倾向于 避免长途绕道，这可能困扰VLB，尤其是当源和目的地彼此靠近时，如图4插图所示。在实践中，就延迟而言，遗忘路由与基于最短路径的方法相比具有十倍的竞争力。 另请注意，尽管MCF针对拥堵进行了优化，但它可能会绕道而行，以避免出现瓶颈。  B. Smore使用多种途径来提高鲁棒性。  VLB通过随机中介路由来实现鲁棒性，避免了将任何特定链接视为关键链接。







# question

* **introduction**

  * 停机时间被定义为丢包率超过0.1％-2％[18]

    陈力当时不是说 数据中心的训练网络中，丢一点包没关系。。？

  * 不都edge-disjoint了么，怎么还会有瓶颈链路的争夺呢？

    edge-disjoint什么意思(似乎在24的reference里面有写)

  * 里面的refer都是啥啊？？

  * **<u>in isolation</u>**怎么跟前面引的还不一样...

  * 内容提供商和ISP的区别?

  * 并且比文献中预测的最坏情况更好？？ 这什么意思。。很值得骄傲么。。。 

  * 我们进行了广泛的评估，将Smore与其他系统在各种情况下进行了比较（第5至6节）。[可以看看带啊吗]

* **system model and related work**

  * **<u>因为更新端到端转发路径是一个相对较慢的操作</u>**   ??? 为什么呢？如果使用segment routing也是很慢的吗？
  * strongly polynomial time ??
  * ==一个完美的框架，应该能利用现有的基础。== MPLS是什么？现在用的多么...

* KSP算法就是top-K个最短路径？CSFP就是按照链路容量贪婪分配？

* TE和TO的区别
* 转发表的大小--》 需要了解下  （几十M没问题？） ask 秦兰成
* 鲁棒优化，可以看看任老师之前关于拥塞的工作
* 专家们之前说了，如果固定了一些路径，那么其他路径就不会被使用，就会造成浪费。那么传统的路由中难道不会有这个问题么？传统的路由不也是先固定了转发表？虽然是逐跳的，但其实还是固定了转发表不是么？



* 想了半天 还是不知道多智能体